<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/ ..\..\FrameXML\UI.xsd">

  <!-- The Dice Master panel for rolling and opening the trait editor. -->
  
  <Frame name="DiceMasterPanel" movable="true" enableMouse="true" frameStrata="MEDIUM" parent="UIParent">
    
    <Size x="100" y="48"/>
    <Anchors>
      <Anchor point="TOP" x="0" y="-64"/>
    </Anchors>	
    <Layers>
      <Layer level="BACKGROUND">
      
        <!-- Panel texture -->
        <Texture file="Interface/AddOns/DiceMaster/Texture/roll-frame">
          <Size x="192" y="48" />
          <Anchors>
            <Anchor point="TOP" x="0" y="0"/>
          </Anchors>
          <TexCoords left="0" right="1" top="0" bottom="0.5" />
        </Texture>
        
      </Layer>
      
      <Layer level="OVERLAY">
        
        <!-- Roll button -->
        <Texture file="Interface/AddOns/DiceMaster/Texture/roll-frame">
          <Size x="48" y="48" />
          <Anchors>
            <Anchor point="TOP" x="80" y="0"/>
          </Anchors>
          <TexCoords left="0" right="0.25" top="0.5" bottom="1" />
        </Texture>
      </Layer>
	  
	  <Layer level="HIGHLIGHT">
		<Texture file="Interface/RAIDFRAME/Raid-Move-Down">
          <Size x="24" y="12" />
          <Anchors>
            <Anchor point="BOTTOM" x="0" y="0"/>
          </Anchors>
        </Texture>
	  </Layer>
    </Layers>
    
    <Scripts>
      <OnLoad>
        self:SetUserPlaced( true )
        self:SetClampedToScreen(true)
        self:RegisterForDrag("LeftButton")
        self:SetScript("OnDragStart", self.StartMoving)
        self:SetScript("OnDragStop", self.StopMovingOrSizing)
        self:SetScale(1)
		
		-- create trait buttons
        self.traits = {}
        for i = 1,5 do
          self.traits[i] = CreateFrame( "DiceMasterTraitButton", nil, self )
          self.traits[i]:SetSize( 24, 24 )
          self.traits[i]:SetPoint( "TOP", -56 + 28*(i-1), 20 )
          self.traits[i].traitIndex = i
		  self.traits[i].editable_trait = true;
		  self.traits[i]:SetScript( "OnMouseDown", function( self, button )
			if IsShiftKeyDown() then DiceMaster4.TraitEditor_OnTraitClicked( self, button ) else DiceMaster4.TraitButtonClicked() DiceMaster4.TraitEditor_StartEditing( self.traitIndex ) end
		end)
        end
      </OnLoad>
    </Scripts>
    
    <Frames>
    
      <!-- Dice format editbox. -->
      <EditBox name="$parentDice" parentKey="dice" font="DiceMasterFontExtraThicc">
      
        <Size x="80" y="14" />
        <Anchors>
          <Anchor point="TOP" x="0" y="-17" />
        </Anchors>
        <Scripts>
          <OnLoad>
            self:SetMaxLetters( 8 )
            self:SetJustifyH( "CENTER" )
            self:SetTextColor( 1, 0.82, 0 );
            self:SetText( "1D20+0" )
            self:SetAutoFocus(false);
          </OnLoad>
          
          <OnEscapePressed function="EditBox_ClearFocus"/>
        </Scripts>
      </EditBox>
      
      <!-- Dice button. -->
      <Button parentKey="roll">
        <Size x="32" y="32"/>
        <Anchors>
          <Anchor point="TOP" x="80" y="-8"/>
        </Anchors>
        
        <HighlightTexture file="Interface/UNITPOWERBARALT/PandarenTrainingLarge_Circular_Flash" alphaMode="ADD" /> 
        
        <Scripts>
          <OnEnter>
            
            GameTooltip:SetOwner(self, "ANCHOR_RIGHT")
            GameTooltip:AddLine( "|cFFFFD100Click to roll " .. DiceMasterPanelDice:GetText() .. "." )
            GameTooltip:Show()
            
          </OnEnter>
          <OnLeave>
            GameTooltip:Hide()
          </OnLeave>
          <OnClick>
            DiceMaster4.RollButtonClicked()
          </OnClick>
        </Scripts>
      </Button>
    </Frames>
  </Frame>
</Ui>
