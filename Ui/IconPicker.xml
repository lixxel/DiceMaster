<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/ ..\..\FrameXML\UI.xsd">

  <!-- Template for the icon buttons in the trait icon selector. -->
  <Button name="DiceMasterIconPickerButton" virtual="true">
    <Size width="28" height="28"/>
    <HighlightTexture file="Interface/BUTTONS/ButtonHilight-Square" alphaMode="ADD"/>
    <Scripts>
      <OnClick>
        DiceMaster4.IconPickerButton_OnClick( self )
      </OnClick>
      <OnEnter>
        DiceMaster4.IconPickerButton_ShowTooltip( self )
      </OnEnter>
      <OnLeave>
        GameTooltip:Hide()
      </OnLeave>
    </Scripts>
  </Button>
  
  <!-- The icon selector, shown when you click on the trait icon to edit the texture. -->
  <Frame name="DiceMasterIconPicker" parent="DiceMasterTraitEditor" hidden="true">
    <Size x="170" y="200" />
    <Anchors>
      <Anchor point="TOPRIGHT" relativePoint="TOPLEFT" x="-48" y="-60" />
    </Anchors>
    
    <Layers>
      <!-- The portrait texture (book icon). -->
      <Layer level="BACKGROUND">
        <Texture file="Interface/SPELLBOOK/Spellbook-Icon">
          <Size x="43" y="43" />
          <Anchors>
            <Anchor point="TOPLEFT" x="-48" y="34" />
          </Anchors>
        </Texture>
      </Layer>
      
      <!-- The main window texture. -->
      <Layer level="BORDER">
        <Texture file="Interface/TUTORIALFRAME/UI-HELP-FRAME-POPUP">
          <Size x="384" y="384"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="-55" y="40" />
          </Anchors>
        </Texture>
      </Layer>
    </Layers>
    
    <Scripts>
      <OnLoad>
        -- create icon map
        self.icons = {}
        for y = 0,4 do
          for x = 0,5 do
            local btn = CreateFrame( "Button", nil, self.selectorFrame, "DiceMasterIconPickerButton" )
            btn.pickerIndex = index
            btn:SetPoint( "TOPLEFT", 32*x-32, -32*y-24 )
            btn:SetSize( 32, 32 )
            
            table.insert( self.icons, btn )
            btn.pickerIndex = #self.icons
          end
        end
      </OnLoad>
    </Scripts>
    <Frames>
    
      <!-- Search/filter box. -->
      <EditBox parentKey="search" inherits="SearchBoxTemplate">
        <Size x="150" y="8" />
        <Anchors>
          <Anchor point="TOPLEFT" x="15" y="0" />
        </Anchors>
        
        <Scripts>
          <OnTextChanged>
            SearchBoxTemplate_OnTextChanged(self);
            DiceMaster4.IconPicker_FilterChanged()
          </OnTextChanged>
          
          
          <OnEscapePressed function="EditBox_ClearFocus"/>
        </Scripts>
      </EditBox>
      
      <!-- Area for icon selector. -->
      <Frame parentKey="selectorFrame">
        <Anchors>
          <Anchor point="TOPLEFT" x="5" y="-5"/>
          <Anchor point="BOTTOMRIGHT" x="-5" y="5"/>
        </Anchors>
        <Scripts>
          <OnLoad>
            self:EnableMouseWheel(true)
          </OnLoad>
          <OnMouseWheel>
            DiceMaster4.IconPicker_MouseScroll( delta )
          </OnMouseWheel>
        </Scripts>
        
        <Frames>
        
          <!-- Scroll bar -->
          <Slider parentKey="scroller" inherits="UIPanelScrollBarTemplate" minvalue="0" maxvalue="1" valuestep="3">
            
            <Anchors>
              <Anchor point="TOPLEFT" relativePoint="TOPRIGHT" x="4" y="-18" />
              <Anchor point="BOTTOMLEFT" relativePoint="BOTTOMRIGHT" x="4" y="18" />
            </Anchors>
            
            <Layers>
              <Layer level="BACKGROUND">
                
                <!-- scroller background -->
                <Texture setAllPoints="true">
                  <Color r="0" g="0" b="0" a="0.25"/>
                </Texture>
                
              </Layer>
            </Layers>
            <Scripts>
              <OnLoad>
                self:SetValueStep(1)
                self.scrollStep = 4
              </OnLoad>
              <OnValueChanged>
                DiceMaster4.IconPicker_ScrollChanged( value )
              </OnValueChanged>
            </Scripts>
          </Slider>
        </Frames>
      </Frame>
      
      <!-- Close button -->
      <Button parentKey="closeButton" inherits="UIPanelCloseButton">
        <Size x="26" y="26"/>
        <Anchors>
          <Anchor point="TOPRIGHT" x="51" y="35" />
        </Anchors>
        
        <Scripts>
          <OnClick>
            DiceMaster4.IconPicker_Close()
          </OnClick>
        </Scripts>
      </Button>
      
    </Frames>
  </Frame>
</Ui>
